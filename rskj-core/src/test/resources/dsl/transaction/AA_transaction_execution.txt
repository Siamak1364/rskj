account_new acc1 10000000
account_new acc2 10000000
# 1. Create AA account
# 2. Create SC
# 3. Send 666 from AA account to SC.

transaction_build tx01
    sender acc1
    receiverAddress 0000000000000000000000000000000001000011 # install code address
    value 0
    # install code params (address ++ bytecode)
    # account[32] + v[32] + r[32] + s[32] + code[-]
    # data 000000000000000000000000a0663f719962ec10bb57865532bef522059dfd96000000000000000000000000000000000000000000000000000000000000001c1a51ea3d88dbc7a4e9fd00807f52c2244c2cd4c8c2e9fbdc7a815518145ab80d054ffa4c1a3c34ae4382bd4d41d98faa7c458c62ea6611f8e0eafb175ab3d39560806040526004361015610018575b361561001657005b005b6000803560e01c9081631626ba7e146100bb5750806332c59bf4146100b257806352709725146100a957806370133bc7146100a05780637368891414610097578063b09b2fdb1461008e578063b8a55e85146100855763c4751d320361000e57610080610261565b61000e565b5061008061045d565b5061008061044b565b506100806103eb565b506100806102a0565b5061008061026b565b50610080610261565b34610133576040600319360112610133576024359067ffffffffffffffff82116101335736602383011215610133576020610109610101366004860135602487016101e0565b600435610e86565b7fffffffff0000000000000000000000000000000000000000000000000000000060405191168152f35b80fd5b50634e487b7160e01b600052604160045260246000fd5b6040810190811067ffffffffffffffff82111761016957604052565b610171610136565b604052565b60c0810190811067ffffffffffffffff82111761016957604052565b90601f601f19910116810190811067ffffffffffffffff82111761016957604052565b601f19601f60209267ffffffffffffffff81116101d3575b01160190565b6101db610136565b6101cd565b9291926101ec826101b5565b916101fa6040519384610192565b829481845281830111610217578281602093846000960137010152565b600080fd5b90816101209103126102175790565b60606003198201126102175760043591602435916044359067ffffffffffffffff82116102175761025e9160040161021c565b90565b506100163661022b565b503461021757600060031936011261021757602073ffffffffffffffffffffffffffffffffffffffff60015416604051908152f35b506102aa3661022b565b9150600090806103d35750813580610348575081630b135d3f60e11b61032f6102f86102d76020966106ed565b935b6102ed6102e582610d7d565b4710156104dc565b61010081019061054d565b9190936103297fffffffff0000000000000000000000000000000000000000000000000000000095869436916101e0565b90610e86565b161461033f575b60405191168152f35b60009150610336565b600381036103695750602091630b135d3f60e11b61032f6102f860006102d7565b60710361038f5781630b135d3f60e11b61032f6102f861038a602096610bad565b6102d7565b606460405162461bcd60e51b815260206004820152601760248201527f456e636f64696e6720756e737570706f727465642074780000000000000000006044820152fd5b91630b135d3f60e11b61032f6102f8602095936102d9565b503461021757600060031936011261021757602073ffffffffffffffffffffffffffffffffffffffff60005416604051908152f35b6020600319820112610217576004359067ffffffffffffffff82116102175761025e9160040161021c565b5061001661045836610420565b610dc6565b5061046736610420565b8035806104a95750806104a361047f610016936106ed565b61048b6102e584610d7d565b61032961049c61010085018561054d565b36916101e0565b50610dc6565b600381036104c05750610016906104a3600061047f565b60710361038f57806104a36104d761001693610bad565b61047f565b156104e357565b608460405162461bcd60e51b815260206004820152602260248201527f4e6f7420656e6f7567682062616c616e636520666f7220666565202b2076616c60448201527f75650000000000000000000000000000000000000000000000000000000000006064820152fd5b9035907fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe181360301821215610217570180359067ffffffffffffffff82116102175760200191813603831361021757565b9081519160005b8381106105b6575050016000815290565b80602080928401015181850152016105a5565b6105f9906105eb6105e59493604051958693602085019061059e565b9061059e565b03601f198101845283610192565b565b50634e487b7160e01b600052603260045260246000fd5b901561061b5790565b61025e6105fb565b604051906106308261014d565b600182527f81000000000000000000000000000000000000000000000000000000000000006020830152565b959293879498979298959195604051998a976020998a8a0161067d9161059e565b6106869161059e565b61068f9161059e565b6106989161059e565b6106a19161059e565b6106aa9161059e565b91823701600081526060519260005b8481106106da575050916105f992016000815203601f198101845283610192565b60808101518184015286935081016106b9565b6107d3906106fe60a082013561097a565b9061072261070f608083013561097a565b61071c606084013561097a565b906105c9565b61074573ffffffffffffffffffffffffffffffffffffffff6040840135166108d9565b61075260c084013561097a565b9060609260e085019367ffffffffffffffff61076e868861054d565b9050169060018214156000146107dd575061078b6107cb91610a19565b945b6107c56107c089518551018651018751018851016107ab848b61054d565b905060605191010167ffffffffffffffff1690565b610ab7565b9661054d565b96909561065c565b6020815191012090565b9490507f80000000000000000000000000000000000000000000000000000000000000006001600160f81b031961082e61082061081a858b61054d565b90610612565b356001600160f81b03191690565b16101561083f575b6107cb9061078d565b93506107cb61084c610623565b949050610836565b604051906108618261014d565b6001825260203681840137565b604051906080820182811067ffffffffffffffff82111761089b575b604052604182526060366020840137565b6108a3610136565b61088a565b906108b2826101b5565b6108bf6040519182610192565b828152601f196108cf82946101b5565b0190602036910137565b906040516108e68161014d565b6015815260217fffffffffffffffffffffffffffffffffffffffff00000000000000000000000082947f9400000000000000000000000000000000000000000000000000000000000000602085015260601b16910152565b60209080511561094c570190565b6109546105fb565b0190565b60609080516040101561094c570190565b60a19080516081101561094c570190565b9060808210156109d65761098c610854565b91806109c457507f80000000000000000000000000000000000000000000000000000000000000005b60001a6109c18361093e565b53565b60f81b6001600160f81b0319166109b5565b6109df82610b24565b916109ec600284016108a8565b926001600160f81b03196081820160f81b1660001a610a0a8561093e565b53601f0360031b1b6021830152565b67ffffffffffffffff1660018114610aa1576038811015610a5d576001600160f81b03196080610a47610854565b920160f81b1660001a610a598261093e565b5390565b610a6681610b24565b90610a73600283016108a8565b916001600160f81b031960b8820160f81b1660001a610a918461093e565b53601f0360031b1b602182015290565b634e487b7160e01b600052600160045260246000fd5b67ffffffffffffffff16906038821015610af0576001600160f81b031960c0610ade610854565b930160f81b1660001a6109c18361093e565b610af982610b24565b91610b06600284016108a8565b926001600160f81b031960f8820160f81b1660001a610a0a8561093e565b906000916fffffffffffffffffffffffffffffffff8111610ba1575b8067ffffffffffffffff60ff9211610b93575b63ffffffff8111610b85575b61ffff8111610b77575b11610b7057565b9060010190565b60029060101c930192610b69565b60049060201c930192610b5f565b60089060401c930192610b53565b6010925060801c610b40565b610d54610d60610c5d92610bc761049c60e083018361054d565b60208151910120604051948591602083019360c08101359060a081013590608081013590606081013590604081013590602081013590358a949192610100969399989794919961012087019a7f192135ce939640eca09b1703f47fdc067a0a240987f051b0ce714ce345b3f03e8852602088015260408701526060860152608085015260a084015260c083015260e08201520152565b0393610c71601f1995868101835282610192565b519020926040516020810190610d0e81610d0246859190606060808401937fc2f8787176b8ac6bf7215b4adcc1e069bf4ab82d9ab1df05a57a91d425935b6e81527f94536914c3c87bf8bccd7c142a04a46168e0bef84c035c2a8dc43a3671b4727060208201527fc89efdaa54c0f20c7adf612882df0950f5a951637e0307cdcb4c672f298b8bc660408201520152565b03848101835282610192565b5190209360405193849160208301968790916042927f19010000000000000000000000000000000000000000000000000000000000008352600283015260228201520190565b03908101835282610192565b51902090565b50634e487b7160e01b600052601160045260246000fd5b60c0608082013591606081013592838102938185041490151715610db2575b01358101809111610daa5790565b61025e610d66565b610dba610d66565b610d9c565b1561021757565b604081013573ffffffffffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff60c0830135818111610e4257610e129161049c91169360e081019061054d565b9080610e2a57506105f99160208251920190f0610dbf565b81600092916105f99460208594519301915af1610dbf565b606460405162461bcd60e51b815260206004820152600860248201527f4f766572666c6f770000000000000000000000000000000000000000000000006044820152fd5b8151630b135d3f60e11b9392907fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7e01610faa575b610ec390611291565b90610ed4610ed082611228565b1590565b8015610f98575b610f8f575b90610eee610ef49284610fe4565b92610fe4565b610f2f610f1660005473ffffffffffffffffffffffffffffffffffffffff1690565b73ffffffffffffffffffffffffffffffffffffffff1690565b73ffffffffffffffffffffffffffffffffffffffff8093161491821592610f5f575b5050610f5957565b60009150565b909150610f84610f1660015473ffffffffffffffffffffffffffffffffffffffff1690565b911614153880610f51565b60009450610ee0565b50610fa5610ed083611228565b610edb565b50610ec3604051610fba81610176565b6082815260a0366020830137601b610fdc8282610fd682610958565b53610969565b539050610eba565b61025e91610ff191611154565b919091611019565b6005111561100357565b634e487b7160e01b600052602160045260246000fd5b61102281610ff9565b8061102a5750565b61103381610ff9565b600181036110805760405162461bcd60e51b815260206004820152601860248201527f45434453413a20696e76616c6964207369676e617475726500000000000000006044820152606490fd5b61108981610ff9565b600281036110d65760405162461bcd60e51b815260206004820152601f60248201527f45434453413a20696e76616c6964207369676e6174757265206c656e677468006044820152606490fd5b806110e2600392610ff9565b146110e957565b60405162461bcd60e51b815260206004820152602260248201527f45434453413a20696e76616c6964207369676e6174757265202773272076616c60448201527f75650000000000000000000000000000000000000000000000000000000000006064820152608490fd5b9060418151146000146111825761117e916020820151906060604084015193015160001a9061118c565b9091565b5050600090600290565b9291907f7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0831161121c5791608094939160ff602094604051948552168484015260408301526060820152600093849182805260015afa1561120f57815173ffffffffffffffffffffffffffffffffffffffff811615611209579190565b50600190565b50604051903d90823e3d90fd5b50505050600090600390565b604181510361127f5760ff6041604083015192015116601b8114159081611285575b5061127f577f7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a01061127a57600190565b600090565b50600090565b601c915014153861124a565b60828151036112f3576112a261086e565b916112ab61086e565b916020810151604082015160ff6041840151169160208701526040860152606085015360618101519060ff608260818301519201511691602085015260408401526060830153565b606460405162461bcd60e51b815260206004820152600e60248201527f496e76616c6964206c656e6774680000000000000000000000000000000000006044820152fdfea2646970667358221220da24021dec85fe914d277d24d136cc32cc99d1a6158acdf08b68c42fe054a4af64736f6c63430008110033
    data 000000000000000000000000a0663f719962ec10bb57865532bef522059dfd96000000000000000000000000000000000000000000000000000000000000001b03e049b663cb700d1e5188216ca4dc344efd0cf755f06bafd3ffd84fe3dff75218fad46dac222c281337e67b2cf5720a5332a14d497197636de1ef778d6f397960806040526004361015610018575b361561001657005b005b60003560e01c80630aee9f17146100b85780631626ba7e146100af57806352709725146100a65780636657b6d51461009d578063736889141461009457806379a6ec161461008b5780637f5f7801146100825763ff4b918f0361000e5761007d610297565b61000e565b5061007d610409565b5061007d610327565b5061007d6102c4565b5061007d610297565b5061007d610262565b5061007d6101f4565b604060031936011261011b5760243567ffffffffffffffff811161011b576100f16100e96020923690600401610120565b600435610592565b7fffffffff0000000000000000000000000000000000000000000000000000000060405191168152f35b600080fd5b908161012091031261011b5790565b50634e487b7160e01b600052604160045260246000fd5b6040810190811067ffffffffffffffff82111761016257604052565b61016a61012f565b604052565b90601f601f19910116810190811067ffffffffffffffff82111761016257604052565b601f19601f60209267ffffffffffffffff81116101b0575b01160190565b6101b861012f565b6101aa565b9291926101c982610192565b916101d7604051938461016f565b82948184528183011161011b578281602093846000960137010152565b503461011b57604060031936011261011b5760243567ffffffffffffffff811161011b573660238201121561011b576102379036906024816004013591016101bd565b5060206040517f1626ba7e000000000000000000000000000000000000000000000000000000008152f35b503461011b57600060031936011261011b57602073ffffffffffffffffffffffffffffffffffffffff60015416604051908152f35b50606060031936011261011b5760443567ffffffffffffffff811161011b57610016903690600401610120565b503461011b57600060031936011261011b57602073ffffffffffffffffffffffffffffffffffffffff60005416604051908152f35b602060031982011261011b576004359067ffffffffffffffff821161011b5761032491600401610120565b90565b50610331366102f9565b8035806103975750806103466100169261095e565b505b61037961035482610f94565b610373610364478311159261065e565b61036d4761065e565b9061043e565b906104f9565b61039161038a610100830183610541565b36916101bd565b50611005565b600381036103aa575b5061001690610348565b6071036103c557806103be61001692610da1565b50906103a0565b606460405162461bcd60e51b815260206004820152601760248201527f456e636f64696e6720756e737570706f727465642074780000000000000000006044820152fd5b50610016610416366102f9565b611005565b60005b83811061042e5750506000910152565b818101518382015260200161041e565b60446104f7919392936040519485917f4e6f7420656e6f7567682062616c616e636520666f7220666565202b2076616c60208401527f75652e000000000000000000000000000000000000000000000000000000000060408401526104ad81518092602060438701910161041b565b82017f2d0000000000000000000000000000000000000000000000000000000000000060438201526104e8825180936020878501910161041b565b0103602481018552018361016f565b565b156105015750565b6044601f91601f1960405193849262461bcd60e51b845260206004850152610538815180928160248801526020888801910161041b565b01168101030190fd5b9035907fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe18136030182121561011b570180359067ffffffffffffffff821161011b5760200191813603831361011b57565b610621578035806105ec575061038a816105ae6105c79361095e565b505b6105bc61035482610f94565b610100810190610541565b507f1626ba7e0000000000000000000000000000000000000000000000000000000090565b60038103610602575b5061038a6105c7916105b0565b6071036103c55761038a816106196105c793610da1565b5091506105f5565b61038a6105c7916105b0565b9061063782610192565b610644604051918261016f565b828152601f196106548294610192565b0190602036910137565b806000917a184f03e93ff9f4daa797ed6e38ed64bf6a1f010000000000000000808210156107be575b506d04ee2d6d415b85acef8100000000808310156107af575b50662386f26fc10000808310156107a0575b506305f5e10080831015610791575b5061271080831015610782575b506064821015610772575b600a80921015610768575b6001908160216106f582870161062d565b95860101905b610707575b5050505090565b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff849101917f30313233343536373839616263646566000000000000000000000000000000008282061a835304918215610763579190826106fb565b610700565b91600101916106e4565b91906064600291049101916106d9565b600491939204910191386106ce565b600891939204910191386106c1565b601091939204910191386106b2565b602091939204910191386106a0565b604093508104915038610687565b60206104f79193929360405194816107ed879351809286808701910161041b565b82016108018251809386808501910161041b565b0103808552018361016f565b3573ffffffffffffffffffffffffffffffffffffffff8116810361011b5790565b50634e487b7160e01b600052603260045260246000fd5b901561084e5790565b61032461082e565b6040519061086382610146565b600182527f81000000000000000000000000000000000000000000000000000000000000006020830152565b9593909796949192859360405199886108b38c9a518092602080809e01910161041b565b8b016108c7825180938c808501910161041b565b016108da825180938b808501910161041b565b016108ed825180938a808501910161041b565b016109008251809389808501910161041b565b016109138251809388808501910161041b565b0191848301370190600081830152836060516000935b818510610947576104f794500160008382015203808552018361016f565b608085015185820185015293830193869250610929565b610a549061096f60a0820135610b6e565b906109936109806080830135610b6e565b61098d6060840135610b6e565b906107cc565b6109c66109c16109a86109a86040860161080d565b73ffffffffffffffffffffffffffffffffffffffff1690565b610aef565b6109d360c0840135610b6e565b9060609260e085019367ffffffffffffffff6109ef8688610541565b905016906001821415600014610a5e5750610a0c610a4c91610c0d565b945b610a46610a418951855101865101875101885101610a2c848b610541565b905060605191010167ffffffffffffffff1690565b610cab565b96610541565b96909561088f565b6020815191012090565b9490507f80000000000000000000000000000000000000000000000000000000000000006001600160f81b0319610aaf610aa1610a9b858b610541565b90610845565b356001600160f81b03191690565b161015610ac0575b610a4c90610a0e565b9350610a4c610acd610856565b949050610ab7565b60405190610ae282610146565b6001825260203681840137565b90604051610afc81610146565b6015815260217fffffffffffffffffffffffffffffffffffffffff00000000000000000000000082947f9400000000000000000000000000000000000000000000000000000000000000602085015260601b16910152565b602090805115610b62570190565b610b6a61082e565b0190565b906080821015610bca57610b80610ad5565b9180610bb857507f80000000000000000000000000000000000000000000000000000000000000005b60001a610bb583610b54565b53565b60f81b6001600160f81b031916610ba9565b610bd382610d18565b91610be06002840161062d565b926001600160f81b03196081820160f81b1660001a610bfe85610b54565b53601f0360031b1b6021830152565b67ffffffffffffffff1660018114610c95576038811015610c51576001600160f81b03196080610c3b610ad5565b920160f81b1660001a610c4d82610b54565b5390565b610c5a81610d18565b90610c676002830161062d565b916001600160f81b031960b8820160f81b1660001a610c8584610b54565b53601f0360031b1b602182015290565b634e487b7160e01b600052600160045260246000fd5b67ffffffffffffffff16906038821015610ce4576001600160f81b031960c0610cd2610ad5565b930160f81b1660001a610bb583610b54565b610ced82610d18565b91610cfa6002840161062d565b926001600160f81b031960f8820160f81b1660001a610bfe85610b54565b906000916fffffffffffffffffffffffffffffffff8111610d95575b8067ffffffffffffffff60ff9211610d87575b63ffffffff8111610d79575b61ffff8111610d6b575b11610d6457565b9060010190565b60029060101c930192610d5d565b60049060201c930192610d53565b60089060401c930192610d47565b6010925060801c610d34565b610f6b610f77610db36020840161080d565b610dbf6040850161080d565b610e74610dd261038a60e0880188610541565b60208151910120604051968793602085019560c08301359260a081013592608082013592606083013592358a9491610100969399989794919961012087019a7f192135ce939640eca09b1703f47fdc067a0a240987f051b0ce714ce345b3f03e8852602088015273ffffffffffffffffffffffffffffffffffffffff8092166040880152166060860152608085015260a084015260c083015260e08201520152565b0393610e88601f199586810183528261016f565b519020926040516020810190610f2581610f1946859190606060808401937fc2f8787176b8ac6bf7215b4adcc1e069bf4ab82d9ab1df05a57a91d425935b6e81527f94536914c3c87bf8bccd7c142a04a46168e0bef84c035c2a8dc43a3671b4727060208201527fc89efdaa54c0f20c7adf612882df0950f5a951637e0307cdcb4c672f298b8bc660408201520152565b0384810183528261016f565b5190209360405193849160208301968790916042927f19010000000000000000000000000000000000000000000000000000000000008352600283015260228201520190565b0390810183528261016f565b51902090565b50634e487b7160e01b600052601160045260246000fd5b60c0608082013591606081013592838102938185041490151715610fc9575b01358101809111610fc15790565b610324610f7d565b610fd1610f7d565b610fb3565b1561011b57565b90601f83604094601f1993602086528160208701528686013760008582860101520116010190565b73ffffffffffffffffffffffffffffffffffffffff6110266040830161080d565b166fffffffffffffffffffffffffffffffff60c08301358181116110c757169160e081019061105861038a8383610541565b9280611072575050506104f79160208251920190f0610fd6565b600080856110ad937f2164e80cbe3c77f27947baf880e3a2cacdb6067cad45fb0323ebf98be3bc034f9860206110b299519301915af1610fd6565b610541565b906110c260405192839283610fdd565b0390a1565b606460405162461bcd60e51b815260206004820152600860248201527f4f766572666c6f770000000000000000000000000000000000000000000000006044820152fdfea2646970667358221220f986ddff568b428dfa247de1a95fdd1f3f35b732fa8274d547046761fdaa6db264736f6c63430008110033
    gas 2000000
    nonce 0
    build

block_build b01
    parent g00
    transactions tx01
    build

block_connect b01

# Assert best block
assert_best b01

# Now create a contract and send a tx through the AA account
transaction_build tx02
    sender acc1
    nonce 1
    receiverAddress 00
    value 0
    data 6080806040526004361015601257600080fd5b60003560e01c63c298557814602657600080fd5b60007ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc360112605957806103e760209252f35b600080fdfea26469706673582212206ca4c9c8b54e9fb98a2594de83034e716d3ca6f3da5718ea465373e9cf5555c864736f6c63430008110033
    gas 1200000
    build

block_build b02
    parent b01
    transactions tx02
    build

block_connect b02

# Assert best block
assert_best b02

# ------- START TYPE AA TX -----------
 transaction_build tx03
    type 03
    sender acc1
    nonce 2
    contract tx02   # created in tx02
    value 666
    data c2985578 # call to foo()
    gas 1000000
    build
# ------- END TYPE AA TX -----------

block_build b03
    parent b02
    transactions tx03
    build

block_connect b03

# Assert best block
assert_best b03

# check account/contract balance (created in tx02)
assert_balance tx02 666

comment
// Code installed in tx02
contract InstalledCode {
   function foo() public payable returns (uint) {
        return 999;
    }
}

// To call foo() => c2985578
end